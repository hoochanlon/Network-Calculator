# ç½‘ç»œè®¡ç®—å™¨ - æ¶æ„ä¸æŠ€æœ¯åŸç†å›¾

æœ¬æ–‡æ¡£åŒ…å«ç½‘ç»œè®¡ç®—å™¨åº”ç”¨çš„æŠ€æœ¯æ¶æ„å›¾å’Œè‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹å›¾ã€‚

## ğŸ“ æŠ€æœ¯æ¶æ„å›¾

### åº”ç”¨æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "ç”¨æˆ·ç•Œé¢å±‚ (UI Layer)"
        A[MainScreen<br/>ä¸»ç•Œé¢] --> B[Sidebar<br/>ä¾§è¾¹æ å¯¼èˆª]
        A --> C[Content Area<br/>å†…å®¹åŒºåŸŸ]
        B --> D[Navigation Items<br/>å¯¼èˆªé¡¹åˆ—è¡¨]
        C --> E[Calculator Screens<br/>è®¡ç®—å™¨ç•Œé¢]
        C --> F[Settings Screen<br/>è®¾ç½®ç•Œé¢]
        C --> G[History Screen<br/>å†å²è®°å½•]
    end

    subgraph "çŠ¶æ€ç®¡ç†å±‚ (State Management)"
        H[LocaleProvider<br/>è¯­è¨€è®¾ç½®] --> A
        I[ThemeProvider<br/>ä¸»é¢˜ç®¡ç†] --> A
        J[CalculatorStateProvider<br/>è®¡ç®—å™¨çŠ¶æ€] --> E
        K[CalculatorSettingsProvider<br/>åº”ç”¨è®¾ç½®] --> F
    end

    subgraph "ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)"
        L[IP Calculator Service<br/>IPåœ°å€è®¡ç®—æœåŠ¡]
        M[Subnet Calculator Service<br/>å­ç½‘æ©ç è®¡ç®—æœåŠ¡]
        N[Base Converter Service<br/>è¿›åˆ¶è½¬æ¢æœåŠ¡]
        O[Network Merge Service<br/>è·¯ç”±èšåˆæœåŠ¡]
        P[Network Split Service<br/>è¶…ç½‘æ‹†åˆ†æœåŠ¡]
        Q[IP Inclusion Service<br/>IPåŒ…å«æ£€æµ‹æœåŠ¡]
        R[History Service<br/>å†å²è®°å½•æœåŠ¡]
    end

    subgraph "æ•°æ®å­˜å‚¨å±‚ (Data Storage)"
        S[SharedPreferences<br/>åº”ç”¨è®¾ç½®å­˜å‚¨]
        T[File System<br/>å†å²è®°å½•æ–‡ä»¶]
        U[Localization Files<br/>å¤šè¯­è¨€æ–‡ä»¶]
    end

    subgraph "å·¥å…·å±‚ (Utils)"
        V[Calculator Name Translator<br/>è®¡ç®—å™¨åç§°ç¿»è¯‘]
        W[Error Message Translator<br/>é”™è¯¯ä¿¡æ¯ç¿»è¯‘]
        X[Sidebar Order Config<br/>ä¾§è¾¹æ æ’åºé…ç½®]
    end

    E --> L
    E --> M
    E --> N
    E --> O
    E --> P
    E --> Q
    G --> R
    F --> K
    K --> S
    R --> T
    H --> U
    E --> V
    E --> W
    B --> X

    style A fill:#e1f5ff
    style H fill:#fff4e6
    style I fill:#fff4e6
    style J fill:#fff4e6
    style K fill:#fff4e6
    style L fill:#f3e5f5
    style M fill:#f3e5f5
    style N fill:#f3e5f5
    style O fill:#f3e5f5
    style P fill:#f3e5f5
    style Q fill:#f3e5f5
    style R fill:#f3e5f5
    style S fill:#e8f5e9
    style T fill:#e8f5e9
    style U fill:#e8f5e9
```

### æ•°æ®æµå›¾

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant UI as ç•Œé¢å±‚
    participant Provider as çŠ¶æ€ç®¡ç†
    participant Service as ä¸šåŠ¡æœåŠ¡
    participant Storage as æ•°æ®å­˜å‚¨

    User->>UI: è¾“å…¥IPåœ°å€/å­ç½‘ä¿¡æ¯
    UI->>Provider: æ›´æ–°è¾“å…¥çŠ¶æ€
    Provider->>UI: è§¦å‘ç•Œé¢æ›´æ–°
    
    User->>UI: ç‚¹å‡»è®¡ç®—æŒ‰é’®
    UI->>Service: è°ƒç”¨è®¡ç®—æœåŠ¡
    Service->>Service: æ‰§è¡Œè®¡ç®—é€»è¾‘
    Service->>Provider: è¿”å›è®¡ç®—ç»“æœ
    Provider->>UI: æ›´æ–°ç»“æœçŠ¶æ€
    UI->>User: æ˜¾ç¤ºè®¡ç®—ç»“æœ
    
    User->>UI: ä¿å­˜åˆ°å†å²è®°å½•
    UI->>Service: è°ƒç”¨å†å²æœåŠ¡
    Service->>Storage: å†™å…¥æ–‡ä»¶ç³»ç»Ÿ
    Storage->>Service: ç¡®è®¤ä¿å­˜
    Service->>Provider: æ›´æ–°å†å²åˆ—è¡¨
    Provider->>UI: åˆ·æ–°å†å²ç•Œé¢
```

### çŠ¶æ€ç®¡ç†æ¶æ„

```mermaid
graph LR
    subgraph "Provider çŠ¶æ€ç®¡ç†"
        A[LocaleProvider<br/>è¯­è¨€çŠ¶æ€] --> B[å½“å‰è¯­è¨€<br/>Locale]
        C[ThemeProvider<br/>ä¸»é¢˜çŠ¶æ€] --> D[ä¸»é¢˜æ¨¡å¼<br/>é¢œè‰²ä¸»é¢˜]
        E[CalculatorStateProvider<br/>è®¡ç®—å™¨çŠ¶æ€] --> F[è¾“å…¥æ•°æ®<br/>è®¡ç®—ç»“æœ]
        G[CalculatorSettingsProvider<br/>åº”ç”¨è®¾ç½®] --> H[çª—å£å°ºå¯¸<br/>å†å²é™åˆ¶<br/>æ’åºé¡ºåº]
    end

    subgraph "æ•°æ®æŒä¹…åŒ–"
        I[SharedPreferences] --> G
        J[æ–‡ä»¶ç³»ç»Ÿ] --> K[å†å²è®°å½•æ–‡ä»¶<br/>history.json]
    end

    subgraph "UI å“åº”"
        L[MainScreen] --> A
        L --> C
        M[Calculator Screens] --> E
        N[Settings Screen] --> G
        O[History Screen] --> K
    end

    A --> L
    C --> L
    E --> M
    G --> N
    K --> O

    style A fill:#fff4e6
    style C fill:#fff4e6
    style E fill:#fff4e6
    style G fill:#fff4e6
    style I fill:#e8f5e9
    style J fill:#e8f5e9
```

### è®¡ç®—æœåŠ¡æ¶æ„

```mermaid
graph TB
    subgraph "è®¡ç®—å™¨æœåŠ¡å±‚"
        A[IP Calculator Service<br/>IPåœ°å€è®¡ç®—] --> B[ç½‘ç»œåœ°å€è®¡ç®—<br/>å¹¿æ’­åœ°å€è®¡ç®—<br/>å¯ç”¨IPèŒƒå›´]
        C[Subnet Calculator Service<br/>å­ç½‘æ©ç è®¡ç®—] --> D[æ ¹æ®ä¸»æœºæ•°è®¡ç®—<br/>æ ¹æ®æ©ç è®¡ç®—<br/>äºŒè¿›åˆ¶/åå…­è¿›åˆ¶è½¬æ¢]
        E[Base Converter Service<br/>è¿›åˆ¶è½¬æ¢] --> F[äºŒè¿›åˆ¶è½¬æ¢<br/>åè¿›åˆ¶è½¬æ¢<br/>åå…­è¿›åˆ¶è½¬æ¢]
        G[Network Merge Service<br/>è·¯ç”±èšåˆ] --> H[Summarizationç®—æ³•<br/>Mergeç®—æ³•<br/>CIDRåˆå¹¶]
        I[Network Split Service<br/>è¶…ç½‘æ‹†åˆ†] --> J[åœ°å€å—æ‹†åˆ†<br/>å­ç½‘åˆ’åˆ†]
        K[IP Inclusion Service<br/>IPåŒ…å«æ£€æµ‹] --> L[CIDRåŒ…å«æ£€æµ‹<br/>IPèŒƒå›´æ£€æµ‹]
    end

    subgraph "è¾“å…¥éªŒè¯"
        M[è¾“å…¥éªŒè¯å™¨] --> A
        M --> C
        M --> E
        M --> G
        M --> I
        M --> K
    end

    subgraph "é”™è¯¯å¤„ç†"
        N[é”™è¯¯ä¿¡æ¯ç¿»è¯‘å™¨] --> O[å¤šè¯­è¨€é”™è¯¯æç¤º]
    end

    A --> N
    C --> N
    E --> N
    G --> N
    I --> N
    K --> N

    style A fill:#f3e5f5
    style C fill:#f3e5f5
    style E fill:#f3e5f5
    style G fill:#f3e5f5
    style I fill:#f3e5f5
    style K fill:#f3e5f5
    style M fill:#fff4e6
    style N fill:#ffebee
```

### å¤šè¯­è¨€æ”¯æŒæ¶æ„

```mermaid
graph TB
    subgraph "æœ¬åœ°åŒ–æ–‡ä»¶"
        A[app_zh.arb<br/>ç®€ä½“ä¸­æ–‡] --> B[AppLocalizations<br/>æœ¬åœ°åŒ–ç±»]
        C[app_zh_HK.arb<br/>ç¹ä½“ä¸­æ–‡] --> B
        D[app_en.arb<br/>è‹±æ–‡] --> B
        E[app_ja.arb<br/>æ—¥æ–‡] --> B
    end

    subgraph "è¯­è¨€ç®¡ç†"
        F[LocaleProvider] --> G[å½“å‰è¯­è¨€è®¾ç½®]
        G --> H[ç³»ç»Ÿè¯­è¨€æ£€æµ‹]
        G --> I[ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©]
    end

    subgraph "åº”ç”¨ä½¿ç”¨"
        J[UIç»„ä»¶] --> B
        K[é”™è¯¯ä¿¡æ¯] --> B
        L[è®¾ç½®ç•Œé¢] --> B
    end

    B --> F
    F --> J
    F --> K
    F --> L

    style A fill:#e8f5e9
    style C fill:#e8f5e9
    style D fill:#e8f5e9
    style E fill:#e8f5e9
    style F fill:#fff4e6
    style B fill:#e1f5ff
```

## ğŸš€ è‡ªåŠ¨åŒ–éƒ¨ç½²ä¸æ‰“åŒ…æµç¨‹å›¾

### å®Œæ•´ CI/CD æµç¨‹

```mermaid
graph TB
    Start([å¼€å§‹]) --> Check{æ£€æŸ¥è§¦å‘æ¡ä»¶}
    
    Check -->|Push to main| WebBuild[æ„å»º Web ç‰ˆæœ¬]
    Check -->|Tag Release| WindowsBuild[æ„å»º Windows ç‰ˆæœ¬]
    Check -->|Both| FullBuild[æ„å»ºæ‰€æœ‰ç‰ˆæœ¬]
    
    WebBuild --> WebTest[Web æ„å»ºæµ‹è¯•]
    WindowsBuild --> WindowsTest[Windows æ„å»ºæµ‹è¯•]
    FullBuild --> WebTest
    FullBuild --> WindowsTest
    
    WebTest -->|å¤±è´¥| WebError[Web æ„å»ºå¤±è´¥]
    WindowsTest -->|å¤±è´¥| WindowsError[Windows æ„å»ºå¤±è´¥]
    
    WebTest -->|æˆåŠŸ| WebDeploy[éƒ¨ç½²åˆ° GitHub Pages]
    WindowsTest -->|æˆåŠŸ| WindowsPackage[æ‰“åŒ… Windows å®‰è£…ç¨‹åº]
    
    WebDeploy --> WebVerify[éªŒè¯ Web éƒ¨ç½²]
    WindowsPackage --> WindowsVerify[éªŒè¯ Windows åŒ…]
    
    WebVerify -->|å¤±è´¥| WebError
    WindowsVerify -->|å¤±è´¥| WindowsError
    
    WebVerify -->|æˆåŠŸ| WebSuccess[Web éƒ¨ç½²æˆåŠŸ]
    WindowsVerify -->|æˆåŠŸ| WindowsSuccess[Windows æ‰“åŒ…æˆåŠŸ]
    
    WebError --> Notify[å‘é€é€šçŸ¥]
    WindowsError --> Notify
    WebSuccess --> Notify
    WindowsSuccess --> Notify
    
    Notify --> End([ç»“æŸ])
    
    style Start fill:#e1f5ff
    style End fill:#e8f5e9
    style WebError fill:#ffebee
    style WindowsError fill:#ffebee
    style WebSuccess fill:#e8f5e9
    style WindowsSuccess fill:#e8f5e9
```

### Web éƒ¨ç½²è¯¦ç»†æµç¨‹

```mermaid
graph LR
    A[ä»£ç æäº¤] --> B[GitHub Actions è§¦å‘]
    B --> C[æ£€å‡ºä»£ç ]
    C --> D[å®‰è£… Flutter SDK]
    D --> E[å®‰è£…ä¾èµ–<br/>flutter pub get]
    E --> F[æ„å»º Web ç‰ˆæœ¬<br/>flutter build web]
    F --> G[ä¼˜åŒ–æ„å»ºäº§ç‰©]
    G --> H[éƒ¨ç½²åˆ° GitHub Pages]
    H --> I[æ›´æ–° SEO Meta æ ‡ç­¾]
    I --> J[éªŒè¯éƒ¨ç½²]
    J --> K{éƒ¨ç½²æˆåŠŸ?}
    K -->|æ˜¯| L[å‘é€æˆåŠŸé€šçŸ¥]
    K -->|å¦| M[å‘é€å¤±è´¥é€šçŸ¥]
    L --> N[å®Œæˆ]
    M --> O[å›æ»š/ä¿®å¤]
    
    style A fill:#e1f5ff
    style N fill:#e8f5e9
    style M fill:#ffebee
    style O fill:#fff4e6
```

### Windows æ‰“åŒ…è¯¦ç»†æµç¨‹

```mermaid
graph TB
    A[ä»£ç æäº¤/åˆ›å»º Tag] --> B[GitHub Actions è§¦å‘]
    B --> C[æ£€å‡ºä»£ç ]
    C --> D[å®‰è£… Flutter SDK]
    D --> E[å®‰è£… Windows å·¥å…·é“¾]
    E --> F[å®‰è£…ä¾èµ–<br/>flutter pub get]
    F --> G[æ„å»º Windows ç‰ˆæœ¬<br/>flutter build windows --release]
    G --> H[æ”¶é›†æ„å»ºäº§ç‰©]
    H --> I[åˆ›å»ºå®‰è£…ç¨‹åº<br/>Inno Setup]
    I --> J[ç”Ÿæˆå®‰è£…åŒ…<br/>.exe æ–‡ä»¶]
    J --> K[åˆ›å»º Release]
    K --> L[ä¸Šä¼ å®‰è£…åŒ…åˆ° GitHub Releases]
    L --> M[æ·»åŠ  Release è¯´æ˜]
    M --> N[éªŒè¯å‘å¸ƒ]
    N --> O{å‘å¸ƒæˆåŠŸ?}
    O -->|æ˜¯| P[å‘é€æˆåŠŸé€šçŸ¥]
    O -->|å¦| Q[å‘é€å¤±è´¥é€šçŸ¥]
    P --> R[å®Œæˆ]
    Q --> S[å›æ»š/ä¿®å¤]
    
    style A fill:#e1f5ff
    style R fill:#e8f5e9
    style Q fill:#ffebee
    style S fill:#fff4e6
```

### æ„å»ºäº§ç‰©ç»“æ„

```mermaid
graph TB
    subgraph "Web æ„å»ºäº§ç‰©"
        A[build/web/] --> B[index.html<br/>å…¥å£æ–‡ä»¶]
        A --> C[main.dart.js<br/>ä¸»åº”ç”¨ä»£ç ]
        A --> D[assets/<br/>èµ„æºæ–‡ä»¶]
        A --> E[icons/<br/>å›¾æ ‡æ–‡ä»¶]
        A --> F[manifest.json<br/>PWA é…ç½®]
    end

    subgraph "Windows æ„å»ºäº§ç‰©"
        G[build/windows/x64/runner/Release/] --> H[network_calculator.exe<br/>å¯æ‰§è¡Œæ–‡ä»¶]
        G --> I[data/<br/>æ•°æ®æ–‡ä»¶]
        G --> J[flutter_windows.dll<br/>Flutter è¿è¡Œæ—¶]
        G --> K[å…¶ä»–ä¾èµ– DLL]
    end

    subgraph "å®‰è£…ç¨‹åº"
        L[installer/] --> M[network_calculator_setup.exe<br/>å®‰è£…ç¨‹åº]
        M --> N[Inno Setup è„šæœ¬<br/>innosetup_script.iss]
    end

    style A fill:#e1f5ff
    style G fill:#e1f5ff
    style L fill:#fff4e6
```

### GitHub Actions å·¥ä½œæµ

```mermaid
graph TB
    subgraph "è§¦å‘æ¡ä»¶"
        A[Push to main] --> B[Web éƒ¨ç½²å·¥ä½œæµ]
        C[Create Tag v*] --> D[Windows æ‰“åŒ…å·¥ä½œæµ]
        E[Manual Dispatch] --> F[æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ]
    end

    subgraph "Web éƒ¨ç½²å·¥ä½œæµ"
        B --> G[Setup Flutter]
        G --> H[Install Dependencies]
        H --> I[Build Web]
        I --> J[Deploy to GitHub Pages]
        J --> K[Update SEO Meta]
    end

    subgraph "Windows æ‰“åŒ…å·¥ä½œæµ"
        D --> L[Setup Flutter]
        L --> M[Setup Windows]
        M --> N[Install Dependencies]
        N --> O[Build Windows]
        O --> P[Create Installer]
        P --> Q[Create Release]
        Q --> R[Upload to Releases]
    end

    subgraph "é€šçŸ¥"
        K --> S[Success Notification]
        R --> S
        F --> T[Status Notification]
    end

    style A fill:#e1f5ff
    style C fill:#e1f5ff
    style E fill:#e1f5ff
    style S fill:#e8f5e9
    style T fill:#fff4e6
```

### éƒ¨ç½²ç¯å¢ƒé…ç½®

```mermaid
graph LR
    subgraph "å¼€å‘ç¯å¢ƒ"
        A[æœ¬åœ°å¼€å‘] --> B[Flutter SDK]
        B --> C[VS Code / Android Studio]
        C --> D[çƒ­é‡è½½è°ƒè¯•]
    end

    subgraph "æ„å»ºç¯å¢ƒ"
        E[GitHub Actions Runner] --> F[Ubuntu Latest<br/>Web æ„å»º]
        E --> G[Windows Latest<br/>Windows æ„å»º]
        F --> H[Flutter SDK]
        G --> H
        H --> I[æ„å»ºå·¥å…·é“¾]
    end

    subgraph "éƒ¨ç½²ç¯å¢ƒ"
        J[GitHub Pages] --> K[é™æ€æ–‡ä»¶æ‰˜ç®¡]
        L[GitHub Releases] --> M[å®‰è£…åŒ…åˆ†å‘]
    end

    D --> E
    I --> J
    I --> L

    style A fill:#e1f5ff
    style E fill:#fff4e6
    style J fill:#e8f5e9
    style L fill:#e8f5e9
```

## ğŸ“ è¯´æ˜

### æŠ€æœ¯æ ˆè¯´æ˜

- **æ¡†æ¶**: Flutter 3.0+ (è·¨å¹³å°æ¡†æ¶)
- **çŠ¶æ€ç®¡ç†**: Provider (å“åº”å¼çŠ¶æ€ç®¡ç†)
- **æœ¬åœ°åŒ–**: flutter_localizations + intl (å¤šè¯­è¨€æ”¯æŒ)
- **æ•°æ®å­˜å‚¨**: SharedPreferences (åº”ç”¨è®¾ç½®) + æ–‡ä»¶ç³»ç»Ÿ (å†å²è®°å½•)
- **UI ç»„ä»¶**: Material Design 3 (ç°ä»£åŒ– UI)
- **æ„å»ºå·¥å…·**: Flutter Build System
- **éƒ¨ç½²å¹³å°**: GitHub Pages (Web) + GitHub Releases (Windows)

### å…³é”®ç‰¹æ€§

1. **æ¨¡å—åŒ–æ¶æ„**: æ¸…æ™°çš„å±‚æ¬¡åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
2. **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ Provider å®ç°å“åº”å¼çŠ¶æ€ç®¡ç†
3. **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰å¤šç§è¯­è¨€
4. **æ•°æ®æŒä¹…åŒ–**: è®¾ç½®å’Œå†å²è®°å½•æŒä¹…åŒ–å­˜å‚¨
5. **è·¨å¹³å°**: åŒä¸€å¥—ä»£ç æ”¯æŒ Web å’Œ Windows å¹³å°
6. **è‡ªåŠ¨åŒ–éƒ¨ç½²**: é€šè¿‡ GitHub Actions å®ç°è‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½²

### éƒ¨ç½²è¯´æ˜

- **Web éƒ¨ç½²**: è‡ªåŠ¨éƒ¨ç½²åˆ° GitHub Pagesï¼Œæ”¯æŒ SEO ä¼˜åŒ–
- **Windows æ‰“åŒ…**: è‡ªåŠ¨æ„å»ºå¹¶åˆ›å»ºå®‰è£…ç¨‹åºï¼Œå‘å¸ƒåˆ° GitHub Releases
- **ç‰ˆæœ¬ç®¡ç†**: é€šè¿‡ Git Tags ç®¡ç†ç‰ˆæœ¬å‘å¸ƒ
- **é€šçŸ¥æœºåˆ¶**: éƒ¨ç½²æˆåŠŸ/å¤±è´¥æ—¶å‘é€é€šçŸ¥

